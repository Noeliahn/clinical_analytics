version: 2

sources:

  - name: aact
    description: >
      ClinicalTrials.gov AACT dataset loaded into the bronze layer.
      Contains metadata, interventions, outcomes, and study results.
    database: clinical_analytics_bronze_db
    schema: raw_data_aact

    config:
      freshness:
        warn_after: {count: 365, period: day}
        error_after: {count: 730, period: day}

    tables:

      # -------------------- conditions --------------------
      - name: conditions
        description: Conditions associated with each clinical study.
        columns:
          - name: id
            description: Internal AACT identifier.
            data_type: varchar
            tests:
              - not_null
          - name: nct_id
            description: ClinicalTrials.gov study identifier.
            data_type: varchar
            tests:
              - not_null
          - name: name
            description: Condition name.
            data_type: varchar
          - name: downcase_name
            description: Lowercase version of the condition name.
            data_type: varchar

      # -------------------- design_group_interventions --------------------
      - name: design_group_interventions
        description: Relationship linking design groups to interventions.
        columns:
          - name: id
            description: Internal AACT identifier.
            data_type: varchar
          - name: nct_id
            description: Study identifier.
            data_type: varchar
          - name: design_group_id
            description: ID of the associated design group.
            data_type: varchar
          - name: intervention_id
            description: ID of the related intervention.
            data_type: varchar

      # -------------------- design_groups --------------------
      - name: design_groups
        description: Clinical trial design groups (study arms).
        columns:
          - name: id
            description: Internal AACT identifier.
            data_type: varchar
          - name: nct_id
            description: Study identifier.
            data_type: varchar
          - name: group_type
            description: Type of group (e.g., Experimental, Placebo).
            data_type: varchar
          - name: title
            description: Title of the group.
            data_type: varchar
          - name: description
            description: Description of the group.
            data_type: varchar

      # -------------------- drop_withdrawals --------------------
      - name: drop_withdrawals
        description: Participant withdrawals and dropouts by group.
        columns:
          - name: id
            description: Internal AACT identifier.
            data_type: varchar
          - name: nct_id
            description: Study identifier.
            data_type: varchar
          - name: result_group_id
            description: ID of the result group.
            data_type: varchar
          - name: ctgov_group_code
            description: ClinicalTrials.gov group code.
            data_type: varchar
          - name: period
            description: Enrollment or study period.
            data_type: varchar
          - name: reason
            description: Withdrawal reason.
            data_type: varchar
          - name: count
            description: Number of participants withdrawn.
            data_type: varchar
          - name: drop_withdraw_comment
            description: Additional comments.
            data_type: varchar
          - name: reason_comment
            description: Reason comment.
            data_type: varchar
          - name: count_units
            description: Units for participant counts.
            data_type: varchar

      # -------------------- facilities --------------------
      - name: facilities
        description: Facility locations where the study was conducted.
        columns:
          - name: id
            description: Internal AACT identifier.
            data_type: varchar
          - name: nct_id
            description: Study identifier.
            data_type: varchar
          - name: status
            description: Recruitment status at the facility.
            data_type: varchar
          - name: name
            description: Facility name.
            data_type: varchar
          - name: city
            description: City of the facility.
            data_type: varchar
          - name: state
            description: State of the facility.
            data_type: varchar
          - name: zip
            description: ZIP code.
            data_type: varchar
          - name: country
            description: Country of the facility.
            data_type: varchar
          - name: latitude
            description: Latitude coordinate.
            data_type: varchar
          - name: longitude
            description: Longitude coordinate.
            data_type: varchar

      # -------------------- interventions --------------------
      - name: interventions
        description: Interventions used in each study.
        columns:
          - name: id
            description: Internal AACT intervention ID.
            data_type: varchar
          - name: nct_id
            description: Study identifier.
            data_type: varchar
          - name: intervention_type
            description: Type of intervention (Drug, Device, Behavioral, etc.).
            data_type: varchar
          - name: name
            description: Name of the intervention.
            data_type: varchar
          - name: description
            description: Detailed description of the intervention.
            data_type: varchar

  

      # -------------------- reported_events_total --------------------
      - name: reported_events_total
        description: Aggregated adverse event totals at the group level.
        columns:
          - name: id
            description: AACT identifier.
            data_type: varchar
          - name: nct_id
            description: Study identifier.
            data_type: varchar
          - name: ctgov_group_code
            description: Group code.
            data_type: varchar
          - name: event_type
            description: Type of event (serious, other).
            data_type: varchar
          - name: classification
            description: Event category/classification.
            data_type: varchar
          - name: subjects_affected
            description: Number of subjects affected.
            data_type: varchar
          - name: subjects_at_risk
            description: Number of subjects at risk.
            data_type: varchar
          - name: created_at
            description: Created timestamp.
            data_type: varchar
          - name: updated_at
            description: Updated timestamp.
            data_type: varchar

      # -------------------- reported_events --------------------
      - name: reported_events
        description: Detailed adverse event reports for each study arm.
        columns:
          - name: id
            description: Internal AACT ID.
            data_type: varchar
          - name: nct_id
            description: Study identifier.
            data_type: varchar
          - name: result_group_id
            description: Result group the event belongs to.
            data_type: varchar
          - name: ctgov_group_code
            description: Group code.
            data_type: varchar
          - name: time_frame
            description: Event occurrence time frame.
            data_type: varchar
          - name: event_type
            description: Type of adverse event.
            data_type: varchar
          - name: default_vocab
            description: Default vocabulary used.
            data_type: varchar
          - name: default_assessment
            description: Event assessment method.
            data_type: varchar
          - name: subjects_affected
            description: Participants affected.
            data_type: varchar
          - name: subjects_at_risk
            description: Participants at risk.
            data_type: varchar
          - name: description
            description: Event description.
            data_type: varchar
          - name: event_count
            description: Count of events.
            data_type: varchar
          - name: organ_system
            description: Organ system involved.
            data_type: varchar
          - name: adverse_event_term
            description: Event term.
            data_type: varchar
          - name: frequency_threshold
            description: Reporting threshold.
            data_type: varchar
          - name: vocab
            description: Vocabulary name.
            data_type: varchar
          - name: assessment
            description: Assessment type.
            data_type: varchar

      # -------------------- sponsors --------------------
      - name: sponsors
        description: Sponsors for each clinical trial.
        columns:
          - name: id
            description: Internal sponsor ID.
            data_type: varchar
          - name: nct_id
            description: Study identifier.
            data_type: varchar
          - name: agency_class
            description: Sponsor agency class.
            data_type: varchar
          - name: lead_or_collaborator
            description: Whether sponsor is lead or collaborator.
            data_type: varchar
          - name: name
            description: Sponsor name.
            data_type: varchar

     

     
