# models/staging/AACT/stg_aact_country_unit_test.yml
unit_tests:
  - name: when_country_is_null_or_empty_country_should_be_unknown
    model: stg_aact_country
    given:
      - input:
          rows:
            - {id: 1, nct_id: 'NCT1', country: 'Spain', status: 'Active', name: 'Facility 1', latitude: 40.0, longitude: -3.7}
            - {id: 2, nct_id: 'NCT2', country: 'france', status: 'Completed', name: 'Facility 2', latitude: 48.8, longitude: 2.3}
            - {id: 3, nct_id: 'NCT3', country: null, status: 'Active', name: 'Facility 3', latitude: 51.5, longitude: -0.1}
            - {id: 4, nct_id: 'NCT4', country: '', status: 'Unknown', name: 'Facility 4', latitude: 52.5, longitude: 13.4}
    expect:
      rows:
        - {id_facilities: 1, nct_id: 'NCT1', country_id: "{{ md5('Spain') }}", country: 'Spain', status_id: "{{ md5('Active') }}", status: 'Active', name: 'Facility 1', latitude: 40.0, longitude: -3.7}
        - {id_facilities: 2, nct_id: 'NCT2', country_id: "{{ md5('france') }}", country: 'france', status_id: "{{ md5('Completed') }}", status: 'Completed', name: 'Facility 2', latitude: 48.8, longitude: 2.3}
        - {id_facilities: 3, nct_id: 'NCT3', country_id: "{{ md5('no_country') }}", country: null, status_id: "{{ md5('Active') }}", status: 'Active', name: 'Facility 3', latitude: 51.5, longitude: -0.1}
        - {id_facilities: 4, nct_id: 'NCT4', country_id: "{{ md5('no_country') }}", country: '', status_id: "{{ md5('Unknown') }}", status: 'Unknown', name: 'Facility 4', latitude: 52.5, longitude: 13.4}
    config:
      tags: ["unit-test"]